select foo3.match_id, foo3.truns as maximum_runs, player.player_name from (select distinct foo2.match_id, foo2.innings_no, foo2.over_id, foo2.truns,ball_by_ball.bowler  from (select match_id, innings_no, over_id, sum(runs) as truns from(select match_id,innings_no, over_id, sum(runs_scored) as runs from batsman_scored group by match_id,innings_no, over_id union ALL select match_id,innings_no, over_id, sum(extra_runs) as runs from extra_runs group by match_id,innings_no, over_id) as foo group by match_id, innings_no, over_id ) as foo2 join ball_by_ball on foo2.match_id=ball_by_ball.match_id and foo2.innings_no=ball_by_ball.innings_no and foo2.over_id=ball_by_ball.over_id where (foo2.match_id, foo2.truns) in (select match_id, max(truns) as runs from (select match_id, innings_no, over_id, sum(runs) as truns from (select match_id,innings_no, over_id, sum(runs_scored) as runs from batsman_scored group by match_id,innings_no, over_id union ALL select match_id,innings_no, over_id, sum(extra_runs) as runs from extra_runs group by match_id,innings_no, over_id) as foo group by match_id, innings_no, over_id) as foo2 group by match_id) ) as foo3 join player on foo3.bowler=player.player_id order by foo3.match_id, foo3.over_id;
